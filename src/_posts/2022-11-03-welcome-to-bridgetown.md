---
layout: post
title:  "Toast alerts with Turbo, Stimulus and Shoelace in Rails"
date:   2022-11-07 14:29:31 -0700
tags: Shoelace Turbo Turbo_Native 
description: "How to create nice toast alerts with Turbo and Shoelace in Ruby on Rails"
template_engine: md
---
Rails comes built-in with a flash alert system to pass along messages to users. The typical method involves displaying a block of text above the main content of the website. While this works, it's not very interactive and can come across as a little dated. In Turbo Native apps, this breaks down the illusion of a Native app, tipping off your user that they're looking at a Web view. 

This tutorial will show how to continue to use the built-in flash alert system in Rails, but Turbo-charge it with [Shoelace Alert Components](https://shoelace.style/components/alert) and Stimulus, while making it play nice with Turbo.

Let's create a new Rails project with Esbuild to bundle our Javascript and PostCSS to process our CSS:

```
rails new alert-demo -j esbuild -c postcss
```

Now we have to setup Shoelace in our project. This is a little more involved then might initially appear, but thankfully [Jared White has done a great job of breaking it down here.](https://dev.to/jaredcwhite/how-to-install-shoelace-with-rails-7-esbuild-and-postcss-1cg9)

Once Shoelace has been setup, let's import the alert component:
```css
/* app/javascript/application.js  */
/* We'll be using the icon in the alerts */

import '@shoelace-style/shoelace/dist/components/alert/alert.js';
import '@shoelace-style/shoelace/dist/components/icon/icon.js';
```

Shoelace is finally setup and ready to go. Let's create a post scaffold to use in our tutorial:

```
rails generate scaffold post content:text
rails db:migrate
```

Finally, head to `http://localhost:3000/posts` to see all of the posts. This should be empty right now. Try creating a new post, and an alert notice should appear in green at the top of the page. It looks very basic, so let's use Shoelace to make it look better.


First off, let's quickly refactor the alert system as it was generated by the scaffold. Let's delete the rendered notice at the top of both `app/views/posts/show.html.erb` and `app/views/posts/index.html.erb`

```erb
<!-- Delete this line! -->
<p style="color: green"><%= notice %></p>
```

Let's create a flash partial:
```erb
<!-- app/views/shared/_flash.html.erb -->

<div data-controller="alert" data-turbo-cache="false"> 
  <% flash.each do |message_type, message| %>
    <sl-alert data-alert-target="alert" open closable>
      <sl-icon slot="icon" name="info-circle"> </sl-icon>
        <%= message %>
    </sl-alert>
  <% end %>
</div>

```


```erb
<!-- app/views/layouts/application.html.erb -->
...
  <body>
    <%= render "shared/flash" %>
    <%= yield %>
  </body>
...

```
